;!function(e){function t(e){return Math.max(Math.min(e,1),0)}function s(e,t,s){return e*(1-s)+t*s}function i(e,s,i){return e===s?e:t((i-e)/(s-e))}function a(e){e="object"==typeof e?e:{},this.suppressWarning=Boolean(e.suppressWarning),this.__local={isRunning:!1,autoStart:!0,callbacks:{},callbackOrder:[],id:0,requestID:null,lastTime:0},this.__loop=this.__loop.bind(this)}a.DEFAULT_NAMESPACE="$$default",a.prototype.on=function(e,t,s){"function"==typeof t?(s=t,"string"==typeof e?t=0:(t=e,e=a.DEFAULT_NAMESPACE)):"function"==typeof e&&(s=e,t=0,e=a.DEFAULT_NAMESPACE),this.__local.callbacks[e]||(this.__local.callbacks[e]=[]);var i={namespace:e,priority:t,id:this.__local.id,callback:s,frame:0,elapsedTime:0};return this.__local.id+=1,this.__local.callbacks[e].push(i),this.__local.callbackOrder.push(i),this.__local.callbackOrder.sort(this.__sort),!this.__local.isRunning&&this.__local.autoStart&&this.start(),this},a.prototype.off=function(e,t){if(t="string"==typeof e?t:e,e="string"==typeof e?e:a.DEFAULT_NAMESPACE,!this.__local.callbacks[e]&&!this.suppressWarning)return console.warn("Loop.off(): namespace '"+e+"' has no callbacks."),this;var s,i;if("function"!=typeof t){for(s=0;s<this.__local.callbacks[e].length;s+=1)-1!==(i=this.__local.callbackOrder.indexOf(this.__local.callbacks[e][s]))&&this.__local.callbackOrder.splice(i,1);delete this.__local.callbacks[e]}else{var o;for(s=this.__local.callbacks[e].length-1;s>=0;s-=1)this.__local.callbacks[e][s].callback===t&&(o=this.__local.callbacks[e].splice(s,1)[0],-1!==(i=this.__local.callbackOrder.indexOf(o))&&this.__local.callbackOrder.splice(i,1));0===this.__local.callbacks[e].length&&delete this.__local.callbacks[e]}return 0===Object.keys(this.__local.callbacks).length&&this.__stop(),this},a.prototype.start=function(){return this.__local.autoStart=!0,this.__local.isRunning?this:(this.__local.isRunning=!0,this.__local.lastTime=Date.now(),this.__local.requestID=requestAnimationFrame(this.__loop),this)},a.prototype.stop=function(){return this.__local.autoStart=!1,this.__stop()},a.prototype.__stop=function(){return this.__local.isRunning?(this.__local.isRunning=!1,cancelAnimationFrame(this.__local.requestID),this):this},a.prototype.__loop=function(){this.__local.requestID=requestAnimationFrame(this.__loop);var e=Date.now(),t=e-this.__local.lastTime;this.__local.lastTime=e;for(var s=0;s<this.__local.callbackOrder.length;s+=1){this.__local.callbackOrder[s].frame+=1,this.__local.callbackOrder[s].elapsedTime+=t;var i={namespace:this.__local.callbackOrder[s].namespace,frame:this.__local.callbackOrder[s].frame,elapsedTimeMS:this.__local.callbackOrder[s].elapsedTime,deltaTimeMS:t,stop:this.off.bind(this,this.__local.callbackOrder[s].namespace,this.__local.callbackOrder[s].callback)};this.__local.callbackOrder[s].callback(i)}},a.prototype.__sort=function(e,t){var s=t.priority-e.priority;return 0!==s?s:e.id-t.id};var o=new a,n={linear:function(e){return e},easeIn:function(e){return function(t){return Math.pow(t,e)}},easeOut:function(e){return function(t){return 1-Math.abs(Math.pow(1-t,e))}},easeInOut:function(e){return function(t){return t<.5?n.easeIn(e)(2*t)/2:n.easeOut(e)(2*t-1)/2+.5}}};n.easeIn2=n.easeIn(2),n.easeIn3=n.easeIn(3),n.easeIn4=n.easeIn(4),n.easeIn5=n.easeIn(5),n.easeOut2=n.easeOut(2),n.easeOut3=n.easeOut(3),n.easeOut4=n.easeOut(4),n.easeOut5=n.easeOut(5),n.easeInOut2=n.easeInOut(2),n.easeInOut3=n.easeInOut(3),n.easeInOut4=n.easeInOut(4),n.easeInOut5=n.easeInOut(5);var l={linear:n.linear,easeIn:n.easeIn2,easeIn2:n.easeIn2,easeIn3:n.easeIn3,easeIn4:n.easeIn4,easeIn5:n.easeIn5,easeOut:n.easeOut2,easeOut2:n.easeOut2,easeOut3:n.easeOut3,easeOut4:n.easeOut4,easeOut5:n.easeOut5,easeInOut:n.easeInOut2,easeInOut2:n.easeInOut2,easeInOut3:n.easeInOut3,easeInOut4:n.easeInOut4,easeInOut5:n.easeInOut5};function r(e){if(e="object"==typeof e?e:{},this.duration="number"==typeof e.duration?e.duration:1e3,"string"==typeof e.ease){if("function"!=typeof l[e.ease])throw new Error("{ ease: '"+e.ease+"' } is not defined.");this.ease=l[e.ease]}else"function"==typeof e.ease?this.ease=e.ease:this.ease=n.linear;this.loop=Boolean(e.loop),this.reverseOnLoop=Boolean(e.reverseOnLoop),this.skipDuplicationFrameOnLoop=Boolean(e.skipDuplicationFrameOnLoop),this.isRunning=!1,this.isReverse=!1,this.progress01=0,this.progress=0,this.__local={events:{play:[],reverse:[],pause:[],progress:[],complete:[],begin:[],reverseBegin:[],reverseComplete:[]},isLoopCompleted:!1,atBegin:!0,atComplete:!1};for(var t,s=this.__local.events,i=Object.keys(s),a=0;a<i.length;a+=1)"function"==typeof e[t="on"+i[a].substr(0,1).toUpperCase()+i[a].substr(1).toLowerCase()]&&s[i[a]].push(e[t]);this.__loop=this.__loop.bind(this)}r.DEFAULT_NAMESPACE="$$animation",r.loop=new a,r.prototype.play=function(){if(this.isRunning&&!this.isReverse||1===this.progress01)return this;var e=this.isRunning;return this.isRunning=!0,this.isReverse=!1,this.__emit("play"),e||r.loop.on(r.DEFAULT_NAMESPACE,this.__loop),this},r.prototype.reverse=function(){if(this.isRunning&&this.isReverse||0===this.progress01)return this;var e=this.isRunning;return this.isRunning=!0,this.isReverse=!0,this.__emit("reverse"),e||r.loop.on(r.DEFAULT_NAMESPACE,this.__loop),this},r.prototype.pause=function(){return this.isRunning?(this.isRunning=!1,r.loop.off(r.DEFAULT_NAMESPACE,this.__loop),this.__emit("pause"),this):this},r.prototype.setProgress01=function(e,s){return this.progress01=t(e),this.progress=this.ease(this.progress01),s||this.__emit("progress",this.progress),this},r.prototype.on=function(e,t){if(null!=this.__local.events[e])return this.__local.events[e].push(t),this;console.warn(e+"does not exist.")},r.prototype.off=function(e,t){if(null==this.__local.events[e])return console.warn(e+"does not exist."),this;if(null==t)this.__local.events[e]=[];else for(var s=this.__local.events[e].length-1;s>=0;s-=1)this.__local.events[e][s]===t&&this.__local.events[e].splice(s,1);return this},r.prototype.__emit=function(e,t){if("progress"!==e){var s=document.createElement("div");s.textContent=e+": "+t,document.body.appendChild(s)}this.__local.events[e].forEach(function(e){e(t)})},r.prototype.__loop=function(e){if(this.__local.isLoopCompleted&&(this.__local.isLoopCompleted=!1,this.loop))if(this.reverseOnLoop)this.__local.atBegin?this.play():this.__local.atComplete&&this.reverse();else if(this.__local.atBegin){if(!this.skipDuplicationFrameOnLoop)return this.__emit("reverseBegin"),this.setProgress01(1),this.__local.atBegin=!1,void(this.__local.atComplete=!1);this.setProgress01(1,!0),this.__local.atBegin=!1,this.__local.atComplete=!0}else if(this.__local.atComplete){if(!this.skipDuplicationFrameOnLoop)return this.__emit("begin"),this.setProgress01(0),this.__local.atBegin=!1,void(this.__local.atComplete=!1);this.setProgress01(0,!0),this.__local.atBegin=!0,this.__local.atComplete=!1}this.__local.atBegin&&!this.isReverse&&(this.__emit("begin"),this.__local.atBegin=!1),this.__local.atComplete&&this.isReverse&&(this.__emit("reverseBegin"),this.__local.atComplete=!1);var t=e.deltaTimeMS/this.duration;this.isReverse&&(t*=-1),this.setProgress01(this.progress01+t),1!==this.progress01||this.isReverse?0===this.progress01&&this.isReverse&&(this.__local.atBegin=!0,this.__emit("reverseComplete"),this.loop?this.__local.isLoopCompleted=!0:(r.loop.off(r.DEFAULT_NAMESPACE,this.__loop),this.isRunning=!1)):(this.__local.atComplete=!0,this.__emit("complete"),this.loop?this.__local.isLoopCompleted=!0:(r.loop.off(r.DEFAULT_NAMESPACE,this.__loop),this.isRunning=!1))};function _(e){var t=!Boolean(e.isOn);this.min="number"==typeof e.min?e.min:0,this.max="number"==typeof e.max?e.max:1,this.value="number"==typeof e.value?e.value:0;var a=this;this.__local={animation:new r({duration:e.duration,ease:e.ease,onProgress:function(t){a.value=s(a.min,a.max,t),e.onUpdate(a.value)}})},this.__local.animation.setProgress01(i(this.min,this.max,this.value)),t&&this.value!==this.max?this.__local.animation.play():t||this.value===this.min||this.__local.animation.reverse()}_.prototype.on=function(){this.__local.animation.play()},_.prototype.off=function(){this.__local.animation.reverse()};var c={Loop:a,Animation:r,Transition:_,Easing:n,loop:o,animate:function(e,t,s){return"function"!=typeof s&&(s=t,t=n.linear),new r({duration:e,ease:t,onProgress:s}).play()},clamp:function(e,t,s){return Math.max(Math.min(e,s),t)},clamp01:t,lerp:s,inverseLerp:i};"undefined"!=typeof module?module.exports=c:e.Dani=c}(this);